<style>

    #__0__ svg {
        border: solid;
        margin: 1em;
    }

    #__0__ circle {
        fill: white;
        stroke: black;
        stroke-width: 2px;
        opacity: .5;
    }

    #__0__ .container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        display: flex;
        justify-content: flex-end;
        align-items: flex-end;
    }

    #__0__ h1 {
        width: 100vw;
        text-align: center;
    }

</style>

<div class="container">
    <a class="runcode btn-floating btn waves-effect waves-light blue stdmargin"><i class="material-icons">play_arrow</i></a>
    <svg class="svg01" height="300" width="300">
        <circle cx="150" cy="150" r="10"></circle>
        <circle cx="150" cy="150" r="10"></circle>
        <circle cx="150" cy="150" r="10"></circle>
    </svg>
</div>

<h1>Add data to DOM elements</h1>
<div class="code1 code"></div>
<div class="code2 code"></div>

<template class="attribute-data1">
    D3 will now put each object into an attribute of each DOM node named <b><code>__data__</code></b>
</template>

<template class="attribute-data2">
    We will now proof that the data is actually inside the DOM nodes.<br>
    <b>But this is just a fun fact.</b><br>
    You don't need to know this to use D3.<br>
    <b>Feel free to move to the next slide right here</b>
</template>

<template class="attribute-data3">
    Now we select the circle DOM node with the plain old <br>
    <b><code>document.querySelectorAll</code></b>,
    read the <b><code>__data__</code></b> attributes and show its contents via <code>window.alert</code><br>
    Run this code via the play button below and you'll see
</template>

<script>

    (function () {
        _0.codeBash(".code1",
            "<svg height=\"300\" width=\"300\">\n" +
            "   <circle cx=\"150\" cy=\"150\" r=\"10\"></circle>\n" +
            "   <circle cx=\"150\" cy=\"150\" r=\"10\"></circle>\n" +
            "   <circle cx=\"150\" cy=\"150\" r=\"10\"></circle>\n" +
            "</svg>");

        _0.codeJs(".code2",
            "d3.selectAll(\"circle\")\n" +
            "   .data(\n" +
            "       [{name:\"a\", x:50, y:50, r:20, color:\"blue\"},\n" +
            "       {name:\"b\", x:50, y:250, r:30, color:\"orange\"},\n" +
            "       {name:\"c\", x:250, y:50, r:40, color:\"red\"}]\n" +
            "   );\n" +
            "\n" +
            "const domNodes = document.querySelectorAll(\"circle\");\n" +
            "window.alert(JSON.stringify(domNodes[0].__data__) + \"\\n\" +\n" +
            "             JSON.stringify(domNodes[1].__data__) + \"\\n\" +\n" +
            "             JSON.stringify(domNodes[2].__data__));");

        const steps = [];
        steps.push(_0.highlightLinesStep(".code1", "1-5", "In our first example we begin with some static SVG nodes", "top"));
        steps.push(_0.highlightLinesStep(".code1", "1-5", "This is only for the sake of this example. Normally you do not start with static SVG nodes!"));
        steps.push(_0.highlightLinesStep(".code1", "2-4", "3 circles", "top"));
        steps.push(_0.highlightLinesStep(".code1", "2", "Each circle ...", "top"));
        steps.push(_0.highlightLinesStep(".code1", "3", " ... has ..."));
        steps.push(_0.highlightLinesStep(".code1", "4", " ... the same radius and position", "top"));

        const tts1 = _0.tooltipStep(".svg01 circle", "Here you can see the circles", "top");
        steps.push(_0.combine(
            _0.highlightLinesStep(".code1", "", ""),
            tts1
        ));

        steps.push(_0.combine(
            _0.highlightLinesStep(".code2", "1-6", "Now we want to add a JavaScript object to each 'circle'-DOM-node", "top"),
            _0.reverse(tts1)
        ));

        steps.push(_0.highlightLinesStep(".code2", "1", "Select the circle nodes (the argument is just a CSS selector)", "top"));
        steps.push(_0.highlightLinesStep(".code2", "2-6", "Add an array of JavaScript objects, ..."));
        steps.push(_0.highlightLinesStep(".code2", "3", " ... the first selected DOM node gets the first object of the array, ..."));
        steps.push(_0.highlightLinesStep(".code2", "4", " ... the second DOM node gets the second object ...", "top"));
        steps.push(_0.highlightLinesStep(".code2", "5", " ... and so on."));

        const tts2 = _0.tooltipStep(".svg01 circle", ".attribute-data1", "top");

        steps.push(_0.combine(
            _0.highlightLinesStep(".code2", "", ""),
            tts2
        ));

        const tts3 = _0.tooltipStep(".svg01 circle", ".attribute-data2");

        steps.push(_0.combine(
            _0.reverse(tts2),
            tts3
        ))

        const tts4 = _0.highlightLinesStep(".code2", "8-11", "Thanks for staying!!!", "top");

        steps.push(_0.combine(
            _0.reverse(tts3),
            tts4,
        ));

        const tts5 = _0.highlightLinesStep(".code2", "8-11", ".attribute-data3", "top");

        steps.push(_0.combine(
            _0.reverse(tts4),
            tts5,
        ));

        steps.push(_0.highlightLinesStep(".code2", "8-11", ".attribute-data3"));
        steps.push(_0.highlightLinesStep(".code2", "9-11"));

        _0.setSteps(steps);

        _0.click(".runcode", () => {
            d3.selectAll("#__0__ circle")
                .data([
                    {name:"a", x:50, y:50, r:20, color:"blue"},
                    {name:"b", x:250, y:50, r:30, color:"orange"},
                    {name:"c", x:50, y:250, r:40, color:"red"}
                ]);

            const domNodes = document.querySelectorAll("#__0__ circle");
            window.alert(JSON.stringify(domNodes[0].__data__) + "\n" +
                JSON.stringify(domNodes[1].__data__) + "\n" +
                JSON.stringify(domNodes[2].__data__));
        });

        ___();
    })()
</script>